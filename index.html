<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>1440TIME™ - The Undeniable Truth of Your Time</title>
  <style>
    /* ------------------- Global Styling ------------------- */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --primary: #00ff88;
      --secondary: #00d4ff;
      --danger: #ff3366;
      --warning: #ffaa00;
      --success: #00ff88;
      --low-return: #ff3366;
      --dark: #0a0a0a;
      --card: rgba(255, 255, 255, 0.03);
      --border: rgba(255, 255, 255, 0.1);
      --on-time-available: #2c2c2c;
      --on-time-label: #00d4ff;
    }

    body {
      background: #000;
      color: #f0f0f0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      min-height: 100vh;
      position: relative;
      overflow-x: hidden;
    }

    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background:
        radial-gradient(circle at 20% 50%, rgba(255, 0, 0, 0.05) 0%, transparent 50%),
        radial-gradient(circle at 80% 50%, rgba(0, 255, 136, 0.05) 0%, transparent 50%);
      pointer-events: none;
      animation: pulse 4s ease-in-out infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 0.5; }
      50% { opacity: 1; }
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 20px;
      position: relative;
      z-index: 2;
    }

    /* ------------------- Header and Main Display ------------------- */
    .header {
      text-align: center;
      margin-bottom: 40px;
      animation: fadeInDown 0.8s ease;
    }

    @keyframes fadeInDown {
      from { opacity: 0; transform: translateY(-30px); }
      to { opacity: 1; transform: translateY(0); }
    }

    h1 {
      font-size: 4rem;
      font-weight: 900;
      background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 50%, var(--danger) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 10px;
      letter-spacing: -3px;
      animation: glow 3s ease-in-out infinite;
    }

    @keyframes glow {
      0%, 100% { filter: brightness(1); }
      50% { filter: brightness(1.2); }
    }

    .tagline {
      color: var(--danger);
      font-size: 1.3rem;
      margin-bottom: 5px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 2px;
    }

    .motto {
      color: #666;
      font-size: 0.9rem;
      text-transform: uppercase;
      letter-spacing: 3px;
    }

    .real-time-counter {
      background: linear-gradient(135deg, rgba(255, 170, 0, 0.1) 0%, rgba(255, 51, 102, 0.1) 100%);
      border: 2px solid var(--warning);
      border-radius: 15px;
      padding: 20px;
      margin-bottom: 30px;
      text-align: center;
      position: relative;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    .real-time-counter-label {
      font-size: 1.2rem;
      color: var(--warning);
      margin-bottom: 5px;
      font-weight: 600;
    }

    .real-time-counter-value {
      font-size: 3rem;
      font-weight: 900;
      background: linear-gradient(90deg, var(--warning), var(--danger));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      line-height: 1;
      letter-spacing: -2px;
    }

    .truth-banner {
      background: linear-gradient(135deg, rgba(255, 51, 102, 0.2) 0%, rgba(255, 51, 102, 0.05) 100%);
      border: 2px solid var(--danger);
      border-radius: 20px;
      padding: 30px;
      margin-bottom: 30px;
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    .truth-banner::before {
      content: '⚠️';
      position: absolute;
      font-size: 200px;
      opacity: 0.05;
      top: -50px;
      right: -50px;
      animation: rotate 20s linear infinite;
    }

    @keyframes rotate {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    .truth-title {
      font-size: 2rem;
      color: var(--danger);
      margin-bottom: 15px;
      font-weight: 900;
      text-transform: uppercase;
    }

    .truth-stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    .truth-stat {
      background: rgba(0, 0, 0, 0.5);
      padding: 15px;
      border-radius: 10px;
      border: 1px solid var(--danger);
    }

    .truth-number {
      font-size: 2.5rem;
      font-weight: 900;
      color: var(--warning);
    }

    .truth-label {
      color: #999;
      font-size: 0.9rem;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .lifetime-counter {
      background: linear-gradient(135deg, rgba(255, 0, 0, 0.1) 0%, rgba(0, 0, 0, 0.5) 100%);
      border: 1px solid var(--danger);
      border-radius: 20px;
      padding: 25px;
      margin-bottom: 30px;
      text-align: center;
      position: relative;
    }

    .lifetime-title {
      font-size: 1.5rem;
      color: var(--warning);
      margin-bottom: 10px;
      font-weight: 700;
    }

    .lifetime-tokens {
      font-size: 3rem;
      font-weight: 900;
      background: linear-gradient(90deg, var(--danger), var(--warning));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .lifetime-bar {
      width: 100%;
      height: 30px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 15px;
      overflow: hidden;
      margin-top: 15px;
      position: relative;
    }

    .lifetime-progress {
      height: 100%;
      background: linear-gradient(90deg, var(--danger), var(--warning));
      transition: width 1s ease;
    }

    .countdown-text {
      position: absolute;
      width: 100%;
      text-align: center;
      line-height: 30px;
      font-weight: 700;
      color: white;
      text-shadow: 0 2px 4px rgba(0,0,0,0.5);
      font-size: 0.9rem;
    }

    /* ------------------- Card and Form Elements ------------------- */
    .card {
      background: var(--card);
      border-radius: 20px;
      padding: 30px;
      margin-bottom: 25px;
      backdrop-filter: blur(20px);
      border: 1px solid var(--border);
      animation: fadeInUp 0.8s ease;
      position: relative;
    }

    .card.reality-check {
      border: 2px solid var(--danger);
      background: linear-gradient(135deg, rgba(255, 51, 102, 0.05) 0%, transparent 100%);
    }

    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(30px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .card-header {
      display: flex;
      align-items: center;
      margin-bottom: 25px;
      padding-bottom: 15px;
      border-bottom: 1px solid var(--border);
    }

    .card-icon {
      font-size: 2rem;
      margin-right: 15px;
    }

    h2 {
      color: var(--primary);
      font-size: 1.5rem;
      font-weight: 600;
    }

    .input-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 25px;
    }

    .input-field {
      display: flex;
      flex-direction: column;
    }

    label {
      color: #888;
      margin-bottom: 8px;
      font-size: 0.85rem;
      text-transform: uppercase;
      letter-spacing: 1px;
      font-weight: 600;
    }

    input, select {
      padding: 12px 15px;
      border-radius: 10px;
      border: 1px solid var(--border);
      background: rgba(255, 255, 255, 0.02);
      color: #f0f0f0;
      font-size: 1rem;
      transition: all 0.3s ease;
    }

    input:focus, select:focus {
      outline: none;
      border-color: var(--primary);
      background: rgba(0, 255, 136, 0.05);
      box-shadow: 0 0 20px rgba(0, 255, 136, 0.1);
    }

    .reality-display {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin: 25px 0;
    }

    .reality-card {
      background: rgba(0, 0, 0, 0.5);
      border-radius: 15px;
      padding: 20px;
      text-align: center;
      border: 2px solid transparent;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .reality-card.low-return {
      border-color: var(--danger);
      background: linear-gradient(135deg, rgba(255, 51, 102, 0.1) 0%, rgba(0, 0, 0, 0.5) 100%);
    }

    .reality-card.productive {
      border-color: var(--success);
      background: linear-gradient(135deg, rgba(0, 255, 136, 0.1) 0%, rgba(0, 0, 0, 0.5) 100%);
    }
    
    .reality-card-on-time {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    .on-time-countdown {
      margin-top: 10px;
      font-size: 1.2rem;
      color: var(--on-time-label);
      font-weight: 700;
    }

    .reality-value {
      font-size: 2.5rem;
      font-weight: 900;
      margin-bottom: 5px;
    }

    .reality-label {
      color: #888;
      font-size: 0.85rem;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 10px;
    }

    .reality-verdict {
      font-size: 0.9rem;
      font-weight: 700;
      padding: 5px 10px;
      border-radius: 5px;
      text-transform: uppercase;
    }

    .verdict-low-return {
      background: rgba(255, 51, 102, 0.2);
      color: var(--low-return);
    }

    .verdict-productive {
      background: rgba(0, 255, 136, 0.2);
      color: var(--success);
    }

    /* ------------------- Time Visualization ------------------- */
    .time-visualization {
      margin: 30px 0;
      padding: 20px;
      background: rgba(0, 0, 0, 0.5);
      border-radius: 15px;
      border: 1px solid var(--border);
    }

    .day-grid {
      display: grid;
      grid-template-columns: repeat(24, 1fr);
      gap: 2px;
      margin-top: 15px;
    }

    .hour-block {
      height: 40px;
      border-radius: 3px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.7rem;
      font-weight: 700;
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .hour-block:hover {
      transform: scale(1.1);
      z-index: 10;
    }

    .hour-sleep { background: linear-gradient(135deg, #9c88ff, #8e7bff); }
    .hour-work { background: #e74c3c; }
    .hour-low-return { background: var(--low-return); }
    .hour-productive { background: var(--success); }
    .hour-available { background: var(--on-time-available); }
    .hour-necessary { background: #3498db; }

    /* ------------------- Activity Log and Buttons ------------------- */
    .activity-categories {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 10px;
      margin: 20px 0;
    }

    .category-btn {
      padding: 15px;
      background: rgba(255, 255, 255, 0.05);
      border: 2px solid var(--border);
      border-radius: 10px;
      color: #f0f0f0;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 0.9rem;
      text-align: center;
      position: relative;
    }

    .category-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
    }

    .category-btn.low-return {
      background: linear-gradient(135deg, rgba(255, 51, 102, 0.1) 0%, transparent 100%);
      border-color: var(--danger);
    }

    .category-btn.productive {
      background: linear-gradient(135deg, rgba(0, 255, 136, 0.1) 0%, transparent 100%);
      border-color: var(--success);
    }

    .category-btn.necessary {
      background: linear-gradient(135deg, rgba(52, 152, 219, 0.1) 0%, transparent 100%);
      border-color: #3498db;
    }

    .category-label {
      display: block;
      font-size: 0.7rem;
      color: #666;
      margin-top: 5px;
      text-transform: uppercase;
    }

    button {
      padding: 15px 30px;
      border-radius: 10px;
      border: none;
      background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
      color: var(--dark);
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 1rem;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    button:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 30px rgba(0, 255, 136, 0.3);
    }

    .entry-form {
      display: grid;
      grid-template-columns: 120px 200px 1fr 180px;
      gap: 15px;
      align-items: end;
      margin-top: 25px;
    }

    .entries-container {
      margin-top: 30px;
      max-height: 500px;
      overflow-y: auto;
      padding-right: 10px;
    }

    .entry-item {
      background: rgba(255, 255, 255, 0.02);
      border-radius: 10px;
      padding: 15px;
      margin-bottom: 12px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border: 1px solid var(--border);
      animation: slideIn 0.3s ease;
      position: relative;
    }

    .entry-item.low-return-entry {
      border-left: 4px solid var(--low-return);
      background: linear-gradient(90deg, rgba(255, 51, 102, 0.05) 0%, transparent 100%);
    }

    .entry-item.productive-entry {
      border-left: 4px solid var(--success);
      background: linear-gradient(90deg, rgba(0, 255, 136, 0.05) 0%, transparent 100%);
    }

    .entry-item.necessary-entry {
      border-left: 4px solid #3498db;
      background: linear-gradient(90deg, rgba(52, 152, 219, 0.05) 0%, transparent 100%);
    }

    @keyframes slideIn {
      from { opacity: 0; transform: translateX(-20px); }
      to { opacity: 1; transform: translateX(0); }
    }

    .entry-info {
      flex-grow: 1;
      display: flex;
      align-items: center;
    }

    .entry-type-badge {
      display: inline-block;
      padding: 4px 10px;
      border-radius: 5px;
      font-size: 0.75rem;
      font-weight: 700;
      margin-right: 15px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .badge-low-return { background: rgba(255, 51, 102, 0.2); color: var(--low-return); }
    .badge-productive { background: rgba(0, 255, 136, 0.2); color: var(--success); }
    .badge-necessary { background: rgba(52, 152, 219, 0.2); color: #3498db; }

    .entry-details { flex-grow: 1; }
    .entry-label-text { font-size: 1rem; font-weight: 600; }
    .entry-minutes-text { font-size: 0.85rem; color: #999; }
    
    .delete-btn {
      background: rgba(255, 51, 102, 0.2);
      padding: 8px 15px;
      color: var(--danger);
      border: 1px solid rgba(255, 51, 102, 0.3);
      font-size: 0.85rem;
      border-radius: 5px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 700;
    }

    .delete-btn:hover {
      background: rgba(255, 51, 102, 0.3);
      box-shadow: 0 5px 15px rgba(255, 51, 102, 0.2);
    }

    /* ------------------- Accountability and History ------------------- */
    .accountability-section {
      background: linear-gradient(135deg, rgba(255, 170, 0, 0.1) 0%, rgba(255, 51, 102, 0.1) 100%);
      border: 2px solid var(--warning);
      border-radius: 15px;
      padding: 25px;
      margin-top: 30px;
      text-align: center;
    }

    .accountability-title {
      font-size: 1.8rem;
      color: var(--warning);
      margin-bottom: 20px;
      font-weight: 900;
      text-transform: uppercase;
    }

    .accountability-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    .accountability-card {
      background: rgba(0, 0, 0, 0.5);
      padding: 20px;
      border-radius: 10px;
      border: 1px solid var(--warning);
    }

    .accountability-value {
      font-size: 2rem;
      font-weight: 900;
      color: var(--danger);
      margin-bottom: 10px;
    }

    .accountability-message {
      color: #ccc;
      font-size: 0.9rem;
      line-height: 1.4;
    }
    
    .historical-insights {
        display: none;
        margin-top: 30px;
        background: linear-gradient(135deg, rgba(0, 255, 136, 0.1) 0%, rgba(0, 212, 255, 0.1) 100%);
        border: 2px solid var(--success);
        border-radius: 20px;
        padding: 30px;
    }
    
    .historical-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 25px;
    }
    
    .calendar-grid {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        gap: 5px;
        margin-top: 20px;
        text-align: center;
    }
    
    .calendar-day-label {
        font-size: 0.8rem;
        color: #999;
        text-transform: uppercase;
        font-weight: 600;
    }
    
    .calendar-day {
        position: relative;
        width: 100%;
        padding-top: 100%;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 5px;
        cursor: pointer;
        transition: all 0.2s ease;
        overflow: hidden;
    }
    
    .calendar-day-content {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        font-size: 1rem;
        font-weight: 700;
    }
    
    .calendar-day:hover {
        transform: scale(1.05);
        box-shadow: 0 0 15px rgba(0, 255, 136, 0.2);
        z-index: 1;
    }
    
    .calendar-day.productive-day { background: var(--success); }
    .calendar-day.low-return-day { background: var(--low-return); }
    .calendar-day.balanced-day { background: var(--warning); }
    .calendar-day.today-day { border: 2px solid var(--secondary); }
    .calendar-day.future-day { opacity: 0.5; cursor: not-allowed; }
    
    .calendar-day-tooltip {
        position: absolute;
        bottom: 110%;
        left: 50%;
        transform: translateX(-50%);
        background: rgba(0, 0, 0, 0.9);
        color: #fff;
        padding: 10px;
        border-radius: 8px;
        white-space: nowrap;
        font-size: 0.8rem;
        pointer-events: none;
        opacity: 0;
        transition: opacity 0.3s ease;
        z-index: 10;
        border: 1px solid var(--border);
    }
    
    .calendar-day:hover .calendar-day-tooltip { opacity: 1; }

    /* ------------------- Mirror and Footer ------------------- */
    .mirror-section {
      background: rgba(0, 0, 0, 0.8);
      border: 3px solid var(--danger);
      border-radius: 20px;
      padding: 30px;
      margin-top: 30px;
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    .mirror-title {
      font-size: 2.5rem;
      color: var(--danger);
      margin-bottom: 20px;
      font-weight: 900;
      text-transform: uppercase;
      animation: pulse 2s infinite;
    }

    .mirror-truth {
      font-size: 1.5rem;
      color: var(--warning);
      margin: 20px 0;
      font-weight: 700;
      line-height: 1.5;
    }

    .commitment-box {
      background: rgba(0, 255, 136, 0.1);
      border: 2px solid var(--success);
      border-radius: 10px;
      padding: 20px;
      margin-top: 30px;
    }

    .commitment-title {
      color: var(--success);
      font-size: 1.3rem;
      margin-bottom: 15px;
      font-weight: 700;
    }

    .commitment-input {
      width: 100%;
      padding: 15px;
      background: rgba(0, 0, 0, 0.5);
      border: 1px solid var(--success);
      border-radius: 10px;
      color: white;
      font-size: 1.1rem;
      margin-bottom: 15px;
    }

    .commit-btn {
      background: linear-gradient(135deg, var(--success) 0%, var(--secondary) 100%);
      width: 100%;
      padding: 15px;
      font-size: 1.2rem;
      font-weight: 900;
    }

    .scrollbar::-webkit-scrollbar { width: 8px; }
    .scrollbar::-webkit-scrollbar-track { background: rgba(255, 255, 255, 0.02); border-radius: 10px; }
    .scrollbar::-webkit-scrollbar-thumb { background: linear-gradient(180deg, var(--danger), var(--warning)); border-radius: 10px; }

    .footer {
      text-align: center;
      margin-top: 50px;
      padding: 20px;
      color: #666;
      font-size: 0.9rem;
      display: flex;
      justify-content: center;
      gap: 15px;
      flex-wrap: wrap;
    }

    .footer .trademark {
      color: var(--primary);
      font-weight: 600;
    }

    @keyframes flash {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    .flash-warning { animation: flash 1s infinite; }
    
    /* ------------------- Modal Styling ------------------- */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(5px);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }

    .modal-content {
      background: var(--dark);
      border: 2px solid var(--primary);
      border-radius: 20px;
      padding: 40px;
      max-width: 600px;
      width: 90%; /* Added for better mobile support */
      text-align: center;
      position: relative;
      animation: modal-fade-in 0.5s ease-out;
      overflow-y: auto; /* Ensure content is scrollable if it exceeds modal height */
      max-height: 90vh;
    }

    @keyframes modal-fade-in {
      from { opacity: 0; transform: scale(0.95); }
      to { opacity: 1; transform: scale(1); }
    }

    .modal-close {
      position: absolute;
      top: 20px;
      right: 20px;
      font-size: 2rem;
      color: var(--secondary);
      cursor: pointer;
      line-height: 1;
    }

    .modal-header {
      font-size: 2.5rem;
      color: var(--primary);
      margin-bottom: 20px;
      font-weight: 900;
      text-transform: uppercase;
    }

    .modal-body p {
      font-size: 1.1rem;
      color: #ccc;
      line-height: 1.6;
      margin-bottom: 15px;
    }

    .modal-body strong {
      color: var(--warning);
      font-weight: 700;
    }
    
    .modal-body .input-field {
        margin-top: 20px;
    }

    .modal-footer button {
      margin-top: 20px;
      padding: 15px 40px;
      font-size: 1.1rem;
    }

    /* ------------------- MOBILE RESPONSIVENESS ------------------- */
    @media (max-width: 768px) {
      .container {
        padding: 10px;
      }
      
      h1 {
        font-size: 2.5rem;
        letter-spacing: -1px;
      }

      .tagline {
        font-size: 1rem;
        letter-spacing: 1px;
      }

      .motto {
        font-size: 0.8rem;
        letter-spacing: 1px;
      }
      
      .real-time-counter {
        padding: 15px;
      }
      
      .real-time-counter-label {
        font-size: 1rem;
      }
      
      .real-time-counter-value {
        font-size: 2.5rem;
      }
      
      .truth-title, .mirror-title {
        font-size: 1.5rem;
      }
      
      .truth-banner, .lifetime-counter, .card, .mirror-section {
        padding: 20px;
      }

      .truth-stats, .reality-display, .accountability-grid, .input-grid {
        grid-template-columns: 1fr;
        gap: 15px;
      }
      
      .lifetime-tokens {
        font-size: 2.5rem;
      }
      
      .card-header h2 {
        font-size: 1.2rem;
      }
      
      .card-header .card-icon {
        font-size: 1.5rem;
      }
      
      .reality-value {
        font-size: 2rem;
      }
      
      .on-time-countdown {
        font-size: 1rem;
      }
      
      .day-grid {
        /* Adjusted for a better fit on smaller screens */
        grid-template-columns: repeat(12, 1fr);
        grid-template-rows: repeat(2, 1fr);
      }
      
      .hour-block {
        height: 25px;
      }
      
      .activity-categories {
        grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
        gap: 8px;
      }

      .category-btn {
        padding: 10px;
        font-size: 0.8rem;
      }
      
      .entry-form {
        grid-template-columns: 1fr;
        gap: 10px;
      }
      
      .entries-container {
        max-height: 300px;
      }
      
      .entry-item {
        flex-direction: column;
        align-items: flex-start;
        gap: 10px;
      }
      
      .entry-info {
        width: 100%;
      }
      
      .delete-btn {
        width: 100%;
        text-align: center;
      }
      
      .accountability-title {
        font-size: 1.5rem;
      }
      
      .accountability-card {
        padding: 15px;
      }
      
      .accountability-value {
        font-size: 1.8rem;
      }
      
      .mirror-truth {
        font-size: 1.2rem;
      }
      
      .commitment-title {
        font-size: 1.1rem;
      }
      
      .commitment-input {
        font-size: 1rem;
      }
      
      .commit-btn {
        font-size: 1rem;
      }
      
      .footer {
        flex-direction: column;
        gap: 10px;
      }
      
      .footer button {
        width: 100%;
      }
      
      .modal-content {
        padding: 20px;
        margin: 10px;
      }
      
      .modal-header {
        font-size: 1.8rem;
      }
      
      .modal-body p {
        font-size: 1rem;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>1440TIME™</h1>
      <p class="tagline">THE CLOCK DOESN'T LIE</p>
      <p class="motto">Your Time Choices Are Now Undeniable</p>
    </div>

    <div class="card reality-check">
      <div class="card-header">
        <span class="card-icon">🔍</span>
        <h2>The Undeniable Truth Configuration</h2>
      </div>

      <div class="input-grid">
        <div class="input-field">
          <label for="age">Your Current Age</label>
          <input type="number" id="age" value="0" min="0" max="120" placeholder="Enter your age">
        </div>
        <div class="input-field">
          <label for="sleep">Sleep Zone (Battery Recharge)</label>
          <input type="number" id="sleep" value="0" min="0" max="24" step="0.5" placeholder="Hours of sleep">
        </div>
        <div class="input-field">
          <label for="work">Livelihood Zone (Door-to-Door)</label>
          <input type="number" id="work" value="0" min="0" max="24" step="0.5" placeholder="Work hours">
        </div>
        <div class="input-field">
          <label for="salary">Annual Salary ($)</label>
          <input type="number" id="salary" value="0" min="0" step="1000" placeholder="Your salary">
        </div>
      </div>

      <div class="reality-display">
        <div class="reality-card" style="border-top: 3px solid #9c88ff; background: linear-gradient(135deg, rgba(156, 136, 255, 0.1) 0%, rgba(0, 0, 0, 0.5) 100%);">
          <div class="reality-value" id="sleepTokens" style="color: #9c88ff;">0</div>
          <div class="reality-label">Sleep Zone Tokens</div>
          <div class="reality-verdict" style="background: rgba(156, 136, 255, 0.2); color: #9c88ff;">🔋 RECHARGE BATTERY</div>
        </div>
        <div class="reality-card" style="border-top: 3px solid #ff7979;">
          <div class="reality-value" id="workTokens" style="color: #ff7979;">0</div>
          <div class="reality-label">Livelihood Zone Tokens</div>
          <div class="reality-verdict" style="background: rgba(255, 121, 121, 0.2); color: #ff7979;">💼 MEANS OF SUPPORT</div>
        </div>
        <div class="reality-card productive reality-card-on-time">
          <div class="reality-value" id="onTimeTokens" style="color: var(--primary);">0</div>
          <div class="reality-label">On-Time Token Zone</div>
          <div class="reality-verdict verdict-productive">🚀 THE DIFFERENCE MAKER</div>
          <div class="on-time-countdown" id="onTimeRemaining">0 TOKENS REMAINING</div>
        </div>
        <div class="reality-card">
          <div class="reality-value" id="dollarPerMin">$0.00</div>
          <div class="reality-label">$ Per Work Minute</div>
          <div class="reality-verdict" id="salaryVerdict">EVALUATED</div>
        </div>
      </div>

      <div class="time-visualization">
        <h3 style="color: var(--warning); margin-bottom: 10px;">YOUR 24-HOUR REALITY</h3>
        <div class="day-grid" id="dayGrid"></div>
      </div>
    </div>

    <div class="real-time-counter">
      <div class="real-time-counter-label">MINUTES LEFT TODAY</div>
      <div class="real-time-counter-value" id="minutesLeftToday">0</div>
    </div>

    <div class="truth-banner">
      <div class="truth-title">⏰ REALITY CHECK: YOUR TIME IS RUNNING OUT</div>
      <div class="truth-stats">
        <div class="truth-stat">
          <div class="truth-number" id="daysLived">0</div>
          <div class="truth-label">Days Already Gone</div>
        </div>
        <div class="truth-stat">
          <div class="truth-number" id="daysLeft">0</div>
          <div class="truth-label">Days Remaining (if lucky)</div>
        </div>
        <div class="truth-stat">
          <div class="truth-number" id="percentLived">0%</div>
          <div class="truth-label">Life Already Spent</div>
        </div>
        <div class="truth-stat">
          <div class="truth-number" id="lowReturnToday">0</div>
          <div class="truth-label" id="lowReturnTodayLabel">Low-Return Minutes Today</div>
        </div>
      </div>
    </div>

    <div class="lifetime-counter">
      <div class="lifetime-title">YOUR LIFETIME TOKEN BALANCE</div>
      <div class="lifetime-tokens" id="lifetimeTokens">0</div>
      <div class="lifetime-bar">
        <div class="lifetime-progress" id="lifetimeProgress"></div>
        <div class="countdown-text" id="lifetimePercent">0% REMAINING</div>
      </div>
    </div>

    <div class="card">
      <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
        <div style="display: flex; align-items: center;">
          <span class="card-icon">⚖️</span>
          <h2>Time Allocation Judgment Center</h2>
        </div>
        <button onclick="startNewDay()" style="
          background: linear-gradient(135deg, var(--success) 0%, var(--secondary) 100%);
          padding: 12px 30px;
          font-size: 1rem;
          border: none;
          border-radius: 10px;
          color: black;
          font-weight: 700;
          cursor: pointer;
          text-transform: uppercase;
          transition: all 0.3s ease;
          box-shadow: 0 4px 15px rgba(0, 255, 136, 0.3);
        " onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 6px 20px rgba(0, 255, 136, 0.5)'" onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 4px 15px rgba(0, 255, 136, 0.3)'">🌅 NEW DAY</button>
      </div>

      <div class="activity-categories">
        <div class="category-btn productive" onclick="setActivity('💪 Physical Fitness', 'productive')">
          💪 Fitness
          <span class="category-label">PRODUCTIVE</span>
        </div>
        <div class="category-btn productive" onclick="setActivity('📚 Learning/Course', 'productive')">
          📚 Learning
          <span class="category-label">PRODUCTIVE</span>
        </div>
        <div class="category-btn productive" onclick="setActivity('🎯 Goal Work', 'productive')">
          🎯 Goals
          <span class="category-label">PRODUCTIVE</span>
        </div>
        <div class="category-btn productive" onclick="setActivity('💻 Side Project', 'productive')">
          💻 Projects
          <span class="category-label">PRODUCTIVE</span>
        </div>
        <div class="category-btn productive" onclick="setActivity('🧘 Meditation', 'productive')">
          🧘 Wellness
          <span class="category-label">PRODUCTIVE</span>
        </div>
        <div class="category-btn low-return" id="socialMediaBtn" onclick="setActivity('📱 Social Media', 'low-return')">
          📱 Social
          <span class="category-label" id="socialMediaLabel">LOW-RETURN</span>
        </div>
        <div class="category-btn low-return" id="netflixBtn" onclick="setActivity('📺 Netflix/TV', 'low-return')">
          📺 TV
          <span class="category-label" id="netflixLabel">LOW-RETURN</span>
        </div>
        <div class="category-btn low-return" id="gamingBtn" onclick="setActivity('🎮 Gaming', 'low-return')">
          🎮 Gaming
          <span class="category-label" id="gamingLabel">LOW-RETURN</span>
        </div>
        <div class="category-btn necessary" onclick="setActivity('🍽️ Eating/Cooking', 'necessary')">
          🍽️ Eating
          <span class="category-label">NECESSARY</span>
        </div>
        <div class="category-btn necessary" onclick="setActivity('🏠 Home Tasks', 'necessary')">
          🏠 Home
          <span class="category-label">NECESSARY</span>
        </div>
        <div class="category-btn necessary" onclick="setActivity('🚗 Commute Extra', 'necessary')">
          🚗 Commute
          <span class="category-label">NECESSARY</span>
        </div>
        <div class="category-btn necessary" onclick="setActivity('👨‍👩‍👧 Family Time', 'necessary')">
          👨‍👩‍👧 Family
          <span class="category-label">NECESSARY</span>
        </div>
      </div>

      <div class="entry-form">
        <div class="input-field">
          <label for="minutes">Tokens</label>
          <input type="number" id="minutes" placeholder="30" min="1">
        </div>
        <div class="input-field">
          <label for="type">Category</label>
          <select id="type">
            <option value="low-return" id="optionLowReturn">Low-Return Tokens</option>
            <option value="necessary">Necessary Tokens</option>
            <option value="productive">Productive Tokens</option>
          </select>
        </div>
        <div class="input-field">
          <label for="label">Activity (Be Honest)</label>
          <input type="text" id="label" placeholder="What are you really doing?">
        </div>
        <button onclick="addEntry()">+ Log Truth</button>
      </div>

      <div class="entries-container scrollbar" id="entriesContainer"></div>
    </div>

    <div class="accountability-section">
      <div class="accountability-title">📊 Your Undeniable Statistics</div>
      <div class="accountability-grid">
        <div class="accountability-card">
          <div class="accountability-value" id="lowReturnPercent">0%</div>
          <div class="accountability-message" id="lowReturnPercentMessage"></div>
        </div>
        <div class="accountability-card">
          <div class="accountability-value" id="productivePercent">0%</div>
          <div class="accountability-message">Of your logged time is PRODUCTIVE</div>
        </div>
        <div class="accountability-card">
          <div class="accountability-value" id="dailyLowReturn">0</div>
          <div class="accountability-message" id="dailyLowReturnMessage"></div>
        </div>
        <div class="accountability-card">
          <div class="accountability-value" id="yearlyLowReturn">0</div>
          <div class="accountability-message" id="yearlyLowReturnMessage"></div>
        </div>
      </div>
    </div>

    <div class="historical-insights">
        <div class="historical-header">
            <h2 style="color: var(--secondary);">📅 Historical Insights</h2>
            <button onclick="toggleHistory()" style="background: var(--border); color: #fff; padding: 8px 15px;">Close History</button>
        </div>
        <div class="calendar-grid" id="calendarGrid"></div>
    </div>

    <div class="mirror-section">
      <div class="mirror-title">🪞 THE MIRROR OF TRUTH</div>
      <div class="mirror-truth" id="mirrorMessage">
        Loading your reality...
      </div>
      <div class="commitment-box">
        <div class="commitment-title">✍️ MAKE YOUR COMMITMENT</div>
        <input type="text" class="commitment-input" id="commitmentInput"
               placeholder="I commit to spending fewer low-return tokens...">
        <button class="commit-btn" onclick="makeCommitment()">SIGN MY TIME CONTRACT</button>
      </div>
    </div>

    <div class="footer">
      <button onclick="openSettings()" style="
        background: var(--border);
        color: #fff;
        padding: 10px 20px;
        font-size: 0.85rem;
        text-transform: uppercase;
      ">⚙️ Settings</button>
      <button onclick="resetEverything()" style="
        background: rgba(255, 51, 102, 0.2);
        border: 1px solid var(--danger);
        color: var(--danger);
        padding: 10px 20px;
        font-size: 0.85rem;
        text-transform: uppercase;
      ">⚠️ Complete System Reset</button>
      <button onclick="toggleHistory()" style="
        background: var(--border);
        color: #fff;
        padding: 10px 20px;
        font-size: 0.85rem;
        text-transform: uppercase;
      ">View Historical Data</button>
      <p class="trademark">Think Outside the Clock™ • Control the Clock – Control the Game™</p>
      <p>© 2024 1440TIME™ System • The Truth is Undeniable</p>
    </div>
  </div>
  
  <!-- Custom Info Modal (Replaces alert()) -->
  <div class="modal-overlay" id="infoModal">
    <div class="modal-content">
      <span class="modal-close" onclick="closeModal('infoModal')">×</span>
      <div class="modal-header">1440TIME™ Notification</div>
      <div class="modal-body">
        <p id="infoModalText"></p>
      </div>
      <div class="modal-footer">
        <button onclick="closeModal('infoModal')">OK</button>
      </div>
    </div>
  </div>

  <!-- Welcome Tour Modal -->
  <div class="modal-overlay" id="welcomeTour">
    <div class="modal-content">
      <span class="modal-close" onclick="closeTour()">×</span>
      <div class="modal-header">Welcome to 1440TIME™</div>
      <div class="modal-body">
        <p>This is the ultimate truth app. It takes your time from an abstract concept and turns it into a concrete, tangible asset—measured in **minutes (tokens)** you can see, own, and spend.</p>
        <p>Your day is divided into three zones:</p>
        <p>1.  **Sleep Zone:** Your essential battery recharge.
        2.  **Livelihood Zone:** Where you earn "time is money."
        3.  **On-Time Token Zone:** The remaining minutes are your **On-Time Tokens**, which you can consciously spend to create the life you want. You are solely responsible for how you spend them.</p>
        <p>The countdown clock at the top and the real-time token counter will hold you accountable. The clock doesn't lie.</p>
      </div>
      <div class="modal-footer">
        <button onclick="closeTour()">I Accept The Truth</button>
      </div>
    </div>
  </div>

  <!-- Settings Modal -->
  <div class="modal-overlay" id="settingsModal">
    <div class="modal-content">
      <span class="modal-close" onclick="closeSettings()">×</span>
      <div class="modal-header">⚙️ Settings</div>
      <div class="modal-body">
        <div class="input-field">
          <label for="tokenTerminology">Choose Your Accountability Terminology</label>
          <select id="tokenTerminology" class="modal-input">
            <option value="low-return">Low-Return Tokens</option>
            <option value="wasted">Wasted Tokens</option>
          </select>
        </div>
      </div>
      <div class="modal-footer">
        <button onclick="closeSettings()">Save & Close</button>
      </div>
    </div>
  </div>

  <script>
    // --- STATE MANAGEMENT ---
    let entries = [];
    let today = new Date().toDateString();
    let currentDate = new Date();
    const LIFETIME_EXPECTANCY_YEARS = 80;
    
    // Default to 'low-return' until user changes it
    let tokenTerminology = 'low-return';
    const terminologyLabels = {
        'low-return': {
            label: 'Low-Return',
            message: 'Low-Return'
        },
        'wasted': {
            label: 'Wasted',
            message: 'Wasted'
        }
    };

    // --- DOM REFERENCES ---
    const ageInput = document.getElementById('age');
    const sleepInput = document.getElementById('sleep');
    const workInput = document.getElementById('work');
    const salaryInput = document.getElementById('salary');
    const minutesInput = document.getElementById('minutes');
    const typeSelect = document.getElementById('type');
    const labelInput = document.getElementById('label');
    const entriesContainer = document.getElementById('entriesContainer');
    const dayGrid = document.getElementById('dayGrid');
    const mirrorMessage = document.getElementById('mirrorMessage');
    const minutesLeftTodayDisplay = document.getElementById('minutesLeftToday');
    const historicalInsights = document.querySelector('.historical-insights');
    const calendarGrid = document.getElementById('calendarGrid');
    const onTimeRemainingDisplay = document.getElementById('onTimeRemaining');
    const welcomeTourModal = document.getElementById('welcomeTour');
    const settingsModal = document.getElementById('settingsModal');
    const tokenTerminologySelect = document.getElementById('tokenTerminology');
    const optionLowReturn = document.getElementById('optionLowReturn');
    const infoModal = document.getElementById('infoModal');
    const infoModalText = document.getElementById('infoModalText');

    // --- DATA PERSISTENCE ---
    const saveState = () => {
      try {
        localStorage.setItem('1440time_entries', JSON.stringify(entries));
        localStorage.setItem('1440time_age', ageInput.value);
        localStorage.setItem('1440time_sleep', sleepInput.value);
        localStorage.setItem('1440time_work', workInput.value);
        localStorage.setItem('1440time_salary', salaryInput.value);
        localStorage.setItem('1440time_today', today);
        localStorage.setItem('1440time_token_terminology', tokenTerminology);
      } catch (e) {
        console.error("Could not save to localStorage: ", e);
      }
    };

    const loadState = () => {
      try {
        const savedEntries = localStorage.getItem('1440time_entries');
        if (savedEntries) {
          entries = JSON.parse(savedEntries);
        }
        const savedToday = localStorage.getItem('1440time_today');
        if (savedToday !== today) {
          saveDailySummary();
          entries = [];
          localStorage.removeItem('1440time_entries');
          localStorage.setItem('1440time_today', today);
        }
        ageInput.value = localStorage.getItem('1440time_age') || '0';
        sleepInput.value = localStorage.getItem('1440time_sleep') || '0';
        workInput.value = localStorage.getItem('1440time_work') || '0';
        salaryInput.value = localStorage.getItem('1440time_salary') || '0';
        tokenTerminology = localStorage.getItem('1440time_token_terminology') || 'low-return';
      } catch (e) {
        console.error("Could not load from localStorage: ", e);
      }
    };
    
    const saveDailySummary = () => {
      try {
        const history = JSON.parse(localStorage.getItem('1440time_history')) || {};
        const lowReturnMinutes = entries.filter(e => e.type === 'low-return').reduce((sum, entry) => sum + entry.minutes, 0);
        const productiveMinutes = entries.filter(e => e.type === 'productive').reduce((sum, entry) => sum + entry.minutes, 0);
        const necessaryMinutes = entries.filter(e => e.type === 'necessary').reduce((sum, entry) => sum + entry.minutes, 0);
        const totalLogged = lowReturnMinutes + productiveMinutes + necessaryMinutes;
        
        const summary = {
            lowReturnMinutes,
            productiveMinutes,
            necessaryMinutes,
            totalLogged,
            terminology: tokenTerminology
        };
        
        const oldDate = localStorage.getItem('1440time_today') || today;
        history[oldDate] = summary;
        localStorage.setItem('1440time_history', JSON.stringify(history));
      } catch (e) {
        console.error("Could not save daily summary: ", e);
      }
    };

    // --- MAIN LOGIC & UI UPDATES ---
    const updateRealTimeCountdown = () => {
      const now = new Date();
      const endOfDay = new Date(now.getFullYear(), now.getMonth(), now.getDate(), 23, 59, 59);
      const millisecondsLeft = endOfDay - now;
      const minutesLeft = Math.ceil(millisecondsLeft / (1000 * 60));
      minutesLeftTodayDisplay.textContent = minutesLeft;
    };
    
    const updateTerminologyUI = () => {
        const term = terminologyLabels[tokenTerminology].label;
        const termMessage = terminologyLabels[tokenTerminology].message;
        
        // Update main stats labels
        document.getElementById('lowReturnTodayLabel').textContent = `${term} Minutes Today`;
        
        // Update category buttons
        const lowReturnCategoryButtons = document.querySelectorAll('.category-btn.low-return .category-label');
        lowReturnCategoryButtons.forEach(el => {
            el.textContent = term.toUpperCase();
        });
        
        // Update accountability stats
        document.getElementById('lowReturnPercentMessage').textContent = `Of your logged time is ${termMessage.toUpperCase()}`;
        document.getElementById('dailyLowReturnMessage').textContent = `Minutes with ${termMessage.toLowerCase()} TODAY`;
        document.getElementById('yearlyLowReturnMessage').textContent = `Hours with ${termMessage.toLowerCase()} this YEAR`;

        // Update form options
        if (optionLowReturn) {
          optionLowReturn.textContent = `${term} Tokens`;
        }
        
        // Update commitment placeholder
        document.getElementById('commitmentInput').placeholder = `I commit to spending fewer ${termMessage.toLowerCase()} tokens...`;
    };

    const updateAllCalculations = () => {
      const age = parseFloat(ageInput.value) || 0;
      const sleep = parseFloat(sleepInput.value) || 0;
      const work = parseFloat(workInput.value) || 0;
      
      if (sleep + work > 24) {
        const message = "Sleep and work hours cannot exceed 24 in total. Please adjust.";
        showInfoModal(message);
        return;
      }
      
      const salary = parseFloat(salaryInput.value) || 0;
      const sleepMinutes = Math.round(sleep * 60);
      const workMinutes = Math.round(work * 60);
      const availableMinutes = 1440 - sleepMinutes - workMinutes;
      
      document.getElementById('sleepTokens').textContent = sleepMinutes;
      document.getElementById('workTokens').textContent = workMinutes;
      document.getElementById('onTimeTokens').textContent = availableMinutes;
      
      // Dollar per minute
      if (salary > 0 && workMinutes > 0) {
        const yearlyWorkMinutes = workMinutes * 5 * 52; 
        const dollarPerMin = (salary / yearlyWorkMinutes).toFixed(2);
        document.getElementById('dollarPerMin').textContent = `$${dollarPerMin}`;
      } else {
        document.getElementById('dollarPerMin').textContent = '$0.00';
      }

      // Lifetime stats
      const totalMinutesInLife = 1440 * 365.25 * LIFETIME_EXPECTANCY_YEARS;
      const minutesLived = Math.round(1440 * 365.25 * age);
      const minutesLeft = totalMinutesInLife - minutesLived;
      const percentLived = (minutesLived / totalMinutesInLife * 100 || 0).toFixed(2);
      
      document.getElementById('daysLived').textContent = Math.round(minutesLived / 1440);
      document.getElementById('daysLeft').textContent = Math.round(minutesLeft / 1440);
      document.getElementById('percentLived').textContent = `${percentLived}%`;
      document.getElementById('lifetimeTokens').textContent = minutesLeft.toLocaleString();
      document.getElementById('lifetimeProgress').style.width = `${percentLived}%`;
      document.getElementById('lifetimePercent').textContent = `${(100 - percentLived).toFixed(2)}% REMAINING`;

      // Daily stats
      const totalLoggedMinutes = entries.reduce((sum, entry) => sum + entry.minutes, 0);
      const lowReturnMinutes = entries.filter(e => e.type === 'low-return').reduce((sum, entry) => sum + entry.minutes, 0);
      const productiveMinutes = entries.filter(e => e.type === 'productive').reduce((sum, entry) => sum + entry.minutes, 0);
      
      document.getElementById('lowReturnToday').textContent = lowReturnMinutes;
      document.getElementById('dailyLowReturn').textContent = lowReturnMinutes;
      
      const lowReturnPercent = (lowReturnMinutes / totalLoggedMinutes * 100 || 0).toFixed(0);
      const productivePercent = (productiveMinutes / totalLoggedMinutes * 100 || 0).toFixed(0);

      document.getElementById('lowReturnPercent').textContent = `${lowReturnPercent}%`;
      document.getElementById('productivePercent').textContent = `${productivePercent}%`;
      document.getElementById('yearlyLowReturn').textContent = (lowReturnMinutes * 365.25 / 60).toFixed(0);
      
      const onTimeRemaining = availableMinutes - totalLoggedMinutes;
      onTimeRemainingDisplay.textContent = `${onTimeRemaining} TOKENS REMAINING`;

      updateMirrorMessage(lowReturnMinutes, productiveMinutes, availableMinutes, totalLoggedMinutes);
      generateDayGrid(sleep, work, entries);
      renderHistoricalData();
    };

    const generateDayGrid = (sleep, work, entries) => {
        dayGrid.innerHTML = '';
        const totalBlocks = 24;
        const totalMinutes = 1440;
        
        const sleepHours = parseFloat(sleep) || 0;
        const workHours = parseFloat(work) || 0;
        
        const sleepBlocks = Math.round((sleepHours / 24) * totalBlocks);
        const workBlocks = Math.round((workHours / 24) * totalBlocks);
        
        let loggedEntries = {};
        entries.forEach(entry => {
            if (!loggedEntries[entry.type]) {
                loggedEntries[entry.type] = 0;
            }
            loggedEntries[entry.type] += entry.minutes;
        });
        
        const loggedBlocks = {};
        let totalLoggedBlocks = 0;
        for (const type in loggedEntries) {
            loggedBlocks[type] = Math.round((loggedEntries[type] / totalMinutes) * totalBlocks);
            totalLoggedBlocks += loggedBlocks[type];
        }
        
        for (let i = 0; i < sleepBlocks; i++) {
            const block = document.createElement('div');
            block.className = `hour-block hour-sleep`;
            block.title = `Sleep Zone (${sleepHours} hours)`;
            dayGrid.appendChild(block);
        }

        for (let i = 0; i < workBlocks; i++) {
            const block = document.createElement('div');
            block.className = `hour-block hour-work`;
            block.title = `Livelihood Zone (${workHours} hours)`;
            dayGrid.appendChild(block);
        }

        let totalOnTimeBlocks = totalBlocks - sleepBlocks - workBlocks;
        let blocksRendered = 0;
        
        const typeOrder = ['productive', 'low-return', 'necessary'];
        typeOrder.forEach(type => {
            const count = loggedBlocks[type] || 0;
            for (let i = 0; i < count; i++) {
                const block = document.createElement('div');
                block.className = `hour-block hour-${type}`;
                block.title = `Logged: ${entries.filter(e => e.type === type).reduce((sum, e) => sum + e.minutes, 0)} minutes (${type})`;
                dayGrid.appendChild(block);
                blocksRendered++;
            }
        });
        
        const availableBlocks = totalOnTimeBlocks - blocksRendered;
        for (let i = 0; i < availableBlocks; i++) {
            const block = document.createElement('div');
            block.className = `hour-block hour-available`;
            block.title = 'Available Time: Log your activities!';
            dayGrid.appendChild(block);
        }
    };
    
    const updateMirrorMessage = (lowReturn, productive, available, totalLogged) => {
      let message = '';
      const termMessage = terminologyLabels[tokenTerminology].message;
      
      const availableLogged = totalLogged;
      const lowReturnPercent = (lowReturn / availableLogged * 100 || 0).toFixed(0);
      const productivePercent = (productive / availableLogged * 100 || 0).toFixed(0);
      
      if (lowReturn > productive && lowReturn > 0) {
        message = `You've spent ${lowReturn} tokens today on ${termMessage.toLowerCase()} activities. This is ${lowReturnPercent}% of your logged time. Your choices matter.`;
        mirrorMessage.classList.add('flash-warning');
      } else if (productive > lowReturn && productive > 0) {
        message = `Great job! You've used ${productive} tokens for productive activities. That's ${productivePercent}% of your logged time. Keep going!`;
        mirrorMessage.classList.remove('flash-warning');
      } else if (lowReturn === 0 && productive === 0) {
        message = `You have ${available} tokens of unallocated time. How will you use it?`;
        mirrorMessage.classList.remove('flash-warning');
      } else {
        message = 'Your time is a reflection of your priorities. What does your day say about you?';
        mirrorMessage.classList.remove('flash-warning');
      }
      
      mirrorMessage.textContent = message;
    };
    
    const renderHistoricalData = () => {
        calendarGrid.innerHTML = '';
        const history = JSON.parse(localStorage.getItem('1440time_history')) || {};
        const termMessage = terminologyLabels[tokenTerminology].message;
        
        const todayKey = new Date().toDateString();
        
        const daysInMonth = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 0).getDate();
        const firstDayOfMonth = new Date(currentDate.getFullYear(), currentDate.getMonth(), 1).getDay();
        
        const dayLabels = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
        dayLabels.forEach(label => {
            const dayLabel = document.createElement('div');
            dayLabel.className = 'calendar-day-label';
            dayLabel.textContent = label;
            calendarGrid.appendChild(dayLabel);
        });
        
        for (let i = 0; i < firstDayOfMonth; i++) {
            const emptyDay = document.createElement('div');
            emptyDay.className = 'calendar-day';
            calendarGrid.appendChild(emptyDay);
        }
        
        for (let i = 1; i <= daysInMonth; i++) {
            const day = new Date(currentDate.getFullYear(), currentDate.getMonth(), i);
            const dateKey = day.toDateString();
            const dayData = history[dateKey];
            
            const dayTile = document.createElement('div');
            dayTile.className = 'calendar-day';
            
            const dayContent = document.createElement('div');
            dayContent.className = 'calendar-day-content';
            dayContent.textContent = i;
            dayTile.appendChild(dayContent);
            
            if (dateKey === todayKey) {
                dayTile.classList.add('today-day');
            }
            
            if (day > new Date()) {
                 dayTile.classList.add('future-day');
            }

            if (dayData) {
                if (dayData.productiveMinutes > dayData.lowReturnMinutes) {
                    dayTile.classList.add('productive-day');
                } else if (dayData.lowReturnMinutes > dayData.productiveMinutes) {
                    dayTile.classList.add('low-return-day');
                } else if (dayData.productiveMinutes > 0 && dayData.lowReturnMinutes > 0) {
                    dayTile.classList.add('balanced-day');
                }
                
                const tooltip = document.createElement('div');
                tooltip.className = 'calendar-day-tooltip';
                tooltip.innerHTML = `
                    <strong>${dateKey}</strong><br>
                    Productive: ${dayData.productiveMinutes} tokens<br>
                    ${termMessage}: ${dayData.lowReturnMinutes} tokens<br>
                    Necessary: ${dayData.necessaryMinutes} tokens
                `;
                dayTile.appendChild(tooltip);
            }
            
            calendarGrid.appendChild(dayTile);
        }
    };
    
    // --- MODAL LOGIC ---
    function showInfoModal(message) {
        const modal = document.getElementById('infoModal');
        const modalText = document.getElementById('infoModalText');
        modalText.textContent = message;
        modal.style.display = 'flex';
    }
    
    function closeModal(id) {
      document.getElementById(id).style.display = 'none';
    }

    window.showTour = function() {
        welcomeTourModal.style.display = 'flex';
    };

    window.closeTour = function() {
        welcomeTourModal.style.display = 'none';
        try {
          localStorage.setItem('1440time_tour_seen', 'true');
        } catch (e) {
          console.error("Could not save tour seen status: ", e);
        }
    };
    
    window.openSettings = function() {
        settingsModal.style.display = 'flex';
        tokenTerminologySelect.value = tokenTerminology;
    };
    
    window.closeSettings = function() {
        tokenTerminology = tokenTerminologySelect.value;
        saveState();
        updateTerminologyUI();
        updateAllCalculations();
        settingsModal.style.display = 'none';
    };
    
    // --- EVENT HANDLERS ---
    
    window.setActivity = function(label, type) {
      labelInput.value = label;
      typeSelect.value = type;
    };
    
    window.addEntry = function() {
      const minutes = parseInt(minutesInput.value);
      const type = typeSelect.value;
      const label = labelInput.value.trim();
      const onTimeTokens = parseFloat(document.getElementById('onTimeTokens').textContent) || 0;
      const totalLoggedMinutes = entries.reduce((sum, entry) => sum + entry.minutes, 0);
      const minutesToAdd = minutes;

      if (isNaN(minutesToAdd) || minutesToAdd <= 0 || label === '') {
        const message = "Please enter a valid duration (in tokens) and a description.";
        showInfoModal(message);
        return;
      }
      
      if (totalLoggedMinutes + minutesToAdd > onTimeTokens) {
        const message = `🚨 WARNING: You have no more On-Time tokens available today! You cannot add more tokens than you have.`;
        showInfoModal(message);
        return;
      }
      
      const newEntry = {
        id: Date.now(),
        minutes,
        type,
        label,
        timestamp: new Date().toLocaleTimeString()
      };
      
      entries.unshift(newEntry);
      saveState();
      renderEntries();
      updateAllCalculations();
      
      minutesInput.value = '';
      labelInput.value = '';
      typeSelect.value = 'low-return';
    };

    window.deleteEntry = function(id) {
      entries = entries.filter(entry => entry.id !== id);
      saveState();
      renderEntries();
      updateAllCalculations();
    };

    const renderEntries = () => {
      entriesContainer.innerHTML = '';
      if (entries.length === 0) {
        entriesContainer.innerHTML = '<p style="text-align: center; color: #555; margin-top: 20px;">No entries logged yet. Start spending your tokens!</p>';
        return;
      }
      
      entries.forEach(entry => {
        const entryDiv = document.createElement('div');
        entryDiv.className = `entry-item ${entry.type}-entry`;
        const termLabel = terminologyLabels[tokenTerminology].label;
        const entryTypeDisplay = entry.type === 'low-return' ? termLabel : entry.type;
        entryDiv.innerHTML = `
          <div class="entry-info">
            <span class="entry-type-badge badge-${entry.type}">${entryTypeDisplay.toUpperCase()}</span>
            <div class="entry-details">
              <span class="entry-label-text">${entry.label}</span>
              <p class="entry-minutes-text">${entry.minutes} tokens • ${entry.timestamp}</p>
            </div>
          </div>
          <button class="delete-btn" onclick="deleteEntry(${entry.id})">Remove</button>
        `;
        entriesContainer.appendChild(entryDiv);
      });
    };
    
    window.startNewDay = function() {
      showInfoModal("Are you sure you want to start a new day? This will save your current day's data to history and reset everything.");
      const confirmationButton = document.querySelector('#infoModal button');
      confirmationButton.textContent = 'Yes, Start New Day';
      confirmationButton.onclick = () => {
        closeModal('infoModal');
        saveDailySummary();
        entries = [];
        localStorage.removeItem('1440time_entries');
        localStorage.setItem('1440time_today', new Date().toDateString());
        today = new Date().toDateString();
        
        renderEntries();
        updateAllCalculations();
      };
    };
    
    window.toggleHistory = function() {
        historicalInsights.style.display = historicalInsights.style.display === 'block' ? 'none' : 'block';
        if (historicalInsights.style.display === 'block') {
             renderHistoricalData();
        }
    };
    
    window.resetEverything = function() {
      showInfoModal("⚠️ WARNING: This will delete ALL data (entries, history, age, salary, etc.) permanently. Are you sure?");
      const confirmationButton = document.querySelector('#infoModal button');
      confirmationButton.textContent = 'Yes, Reset Everything';
      confirmationButton.onclick = () => {
        closeModal('infoModal');
        try {
          localStorage.clear();
        } catch (e) {
          console.error("Could not clear localStorage: ", e);
        }
        entries = [];
        
        ageInput.value = '0';
        sleepInput.value = '0';
        workInput.value = '0';
        salaryInput.value = '0';
        
        renderEntries();
        updateAllCalculations();
        showInfoModal("System reset complete. All data has been erased.");
      };
    };
    
    window.makeCommitment = function() {
      const commitment = document.getElementById('commitmentInput').value.trim();
      if (commitment) {
        const message = `Commitment made: "${commitment}"\n\nNow, prove it with your actions.`;
        showInfoModal(message);
        document.getElementById('commitmentInput').value = '';
      } else {
        const message = "Please write your commitment before signing.";
        showInfoModal(message);
      }
    };
    
    // --- INITIALIZATION ---
    
    const initialize = () => {
      loadState();
      
      ageInput.addEventListener('input', updateAllCalculations);
      sleepInput.addEventListener('input', updateAllCalculations);
      workInput.addEventListener('input', updateAllCalculations);
      salaryInput.addEventListener('input', updateAllCalculations);
      
      renderEntries();
      updateTerminologyUI();
      updateAllCalculations();
      updateRealTimeCountdown();
      
      setInterval(updateRealTimeCountdown, 60000); 

      const tourSeen = localStorage.getItem('1440time_tour_seen');
      if (!tourSeen) {
          showTour();
      }
      
      // Ensure modals are initially hidden
      welcomeTourModal.style.display = 'none';
      settingsModal.style.display = 'none';
      infoModal.style.display = 'none';
    };

    document.addEventListener('DOMContentLoaded', initialize);
  </script>
</body>
</html>
